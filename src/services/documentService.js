// Service for handling document operations and file management
class DocumentService {
  constructor() {
    this.baseUrl = process.env.REACT_APP_API_URL || 'http://localhost:3001';
  }

  // Get document metadata from file path
  getDocumentMetadata(filePath) {
    const fileName = filePath.split('/').pop();
    const cleanName = fileName.replace('.pdf', '').replace(/à¸ªà¸·à¹ˆà¸­à¸„à¸§à¸²à¸¡à¸ªà¸²à¸‚à¸²-_?-?/, '');
    
    // Extract date information from folder structure
    const folderMatch = filePath.match(/(\d{2})-\d{8}T\d{6}Z-\d+-\d{3}/);
    const month = folderMatch ? parseInt(folderMatch[1]) : new Date().getMonth() + 1;
    
    const monthNames = [
      'à¸¡à¸à¸£à¸²à¸„à¸¡', 'à¸à¸¸à¸¡à¸ à¸²à¸žà¸±à¸™à¸˜à¹Œ', 'à¸¡à¸µà¸™à¸²à¸„à¸¡', 'à¹€à¸¡à¸©à¸²à¸¢à¸™', 'à¸žà¸¤à¸©à¸ à¸²à¸„à¸¡', 'à¸¡à¸´à¸–à¸¸à¸™à¸²à¸¢à¸™',
      'à¸à¸£à¸à¸Žà¸²à¸„à¸¡', 'à¸ªà¸´à¸‡à¸«à¸²à¸„à¸¡', 'à¸à¸±à¸™à¸¢à¸²à¸¢à¸™', 'à¸•à¸¸à¸¥à¸²à¸„à¸¡', 'à¸žà¸¤à¸¨à¸ˆà¸´à¸à¸²à¸¢à¸™', 'à¸˜à¸±à¸™à¸§à¸²à¸„à¸¡'
    ];
    
    return {
      fileName: cleanName,
      month: monthNames[month - 1] || 'à¹„à¸¡à¹ˆà¸£à¸°à¸šà¸¸',
      monthNumber: month,
      year: 2567, // Buddhist year
      size: this.estimateFileSize(cleanName),
      type: this.getDocumentType(cleanName)
    };
  }

  // Estimate file size based on content type
  estimateFileSize(fileName) {
    if (fileName.includes('Incentive') || fileName.includes('KPI')) {
      return Math.floor(Math.random() * 500) + 1200; // 1200-1700 KB
    } else if (fileName.includes('à¸›à¸£à¸°à¸à¸±à¸™')) {
      return Math.floor(Math.random() * 300) + 800; // 800-1100 KB
    } else if (fileName.includes('à¸ˆà¸³à¸™à¸³')) {
      return Math.floor(Math.random() * 400) + 1000; // 1000-1400 KB
    }
    return Math.floor(Math.random() * 200) + 600; // 600-800 KB
  }

  // Determine document type from filename
  getDocumentType(fileName) {
    if (fileName.includes('Incentive')) return 'incentive';
    if (fileName.includes('KPI')) return 'kpi';
    if (fileName.includes('à¸›à¸£à¸°à¸à¸±à¸™')) return 'insurance';
    if (fileName.includes('à¸ˆà¸³à¸™à¸³')) return 'mortgage';
    if (fileName.includes('Turbo')) return 'product';
    return 'general';
  }

  // Generate keywords based on filename and type
  generateKeywords(fileName, type) {
    const baseKeywords = ['à¸ªà¸²à¸‚à¸²', 'à¸„à¸¹à¹ˆà¸¡à¸·à¸­', 'à¹à¸™à¸§à¸—à¸²à¸‡'];
    const typeKeywords = {
      incentive: ['Incentive', 'à¹‚à¸šà¸™à¸±à¸ª', 'à¸„à¹ˆà¸²à¸•à¸­à¸šà¹à¸—à¸™', 'à¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢', 'à¸¢à¸­à¸”à¸‚à¸²à¸¢'],
      kpi: ['KPI', 'à¸•à¸±à¸§à¸Šà¸µà¹‰à¸§à¸±à¸”', 'à¸›à¸£à¸°à¹€à¸¡à¸´à¸™à¸œà¸¥', 'à¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢', 'à¸œà¸¥à¸‡à¸²à¸™'],
      insurance: ['à¸›à¸£à¸°à¸à¸±à¸™à¸ à¸±à¸¢', 'à¸›à¸£à¸°à¸à¸±à¸™à¸£à¸–à¸¢à¸™à¸•à¹Œ', 'à¸›à¸£à¸°à¸à¸±à¸™à¸­à¸¸à¸šà¸±à¸•à¸´à¹€à¸«à¸•à¸¸', 'à¸›à¸£à¸°à¸à¸±à¸™à¸ªà¸¸à¸‚à¸ à¸²à¸ž'],
      mortgage: ['à¸ˆà¸³à¸™à¸³', 'à¸ªà¸´à¸™à¹€à¸Šà¸·à¹ˆà¸­', 'à¸«à¸¥à¸±à¸à¸—à¸£à¸±à¸žà¸¢à¹Œ', 'à¸”à¸­à¸à¹€à¸šà¸µà¹‰à¸¢', 'à¸›à¸£à¸°à¹€à¸¡à¸´à¸™'],
      product: ['à¸œà¸¥à¸´à¸•à¸ à¸±à¸“à¸‘à¹Œ', 'à¸à¸²à¸£à¸•à¸¥à¸²à¸”', 'à¹‚à¸›à¸£à¹‚à¸¡à¸Šà¸±à¹ˆà¸™', 'à¸¥à¸¹à¸à¸„à¹‰à¸²'],
      general: ['à¸‚à¹‰à¸­à¸¡à¸¹à¸¥', 'à¸£à¸°à¸šà¸š', 'à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™', 'à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™']
    };

    const keywords = [...baseKeywords, ...(typeKeywords[type] || typeKeywords.general)];
    
    // Add specific keywords from filename
    if (fileName.includes('à¸£à¸°à¸”à¸±à¸šà¸ªà¸²à¸‚à¸²')) keywords.push('à¸£à¸°à¸”à¸±à¸šà¸ªà¸²à¸‚à¸²');
    if (fileName.includes('à¸£à¸°à¸”à¸±à¸šà¸žà¸·à¹‰à¸™à¸—à¸µà¹ˆ')) keywords.push('à¸£à¸°à¸”à¸±à¸šà¸žà¸·à¹‰à¸™à¸—à¸µà¹ˆ');
    if (fileName.includes('à¸œà¸¹à¹‰à¸ˆà¸±à¸”à¸à¸²à¸£')) keywords.push('à¸œà¸¹à¹‰à¸ˆà¸±à¸”à¸à¸²à¸£');
    if (fileName.includes('2025')) keywords.push('2025');
    
    return keywords.slice(0, 8); // Limit to 8 keywords
  }

  // Generate summary based on document type and filename
  generateSummary(fileName, type, metadata) {
    const templates = {
      incentive: `à¸„à¸¹à¹ˆà¸¡à¸·à¸­à¸à¸²à¸£à¸„à¸³à¸™à¸§à¸“à¹à¸¥à¸°à¸ˆà¹ˆà¸²à¸¢ Incentive à¸ªà¸³à¸«à¸£à¸±à¸šà¸žà¸™à¸±à¸à¸‡à¸²à¸™ à¸›à¸£à¸°à¸ˆà¸³à¹€à¸”à¸·à¸­à¸™${metadata.month} ${metadata.year} à¸„à¸£à¸­à¸šà¸„à¸¥à¸¸à¸¡à¹€à¸à¸“à¸‘à¹Œà¸à¸²à¸£à¸›à¸£à¸°à¹€à¸¡à¸´à¸™ KPI à¸à¸²à¸£à¸„à¸³à¸™à¸§à¸“à¸„à¹ˆà¸²à¸•à¸­à¸šà¹à¸—à¸™à¹€à¸žà¸´à¹ˆà¸¡à¹€à¸•à¸´à¸¡ à¹à¸¥à¸°à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸à¸²à¸£à¹€à¸šà¸´à¸à¸ˆà¹ˆà¸²à¸¢ à¸£à¸§à¸¡à¸–à¸¶à¸‡à¹à¸™à¸§à¸—à¸²à¸‡à¸à¸²à¸£à¸ˆà¸±à¸”à¸à¸²à¸£à¸›à¸£à¸°à¸à¸±à¸™à¸ à¸±à¸¢à¹à¸¥à¸°à¸œà¸¥à¸´à¸•à¸ à¸±à¸“à¸‘à¹Œà¸ªà¸´à¸™à¹€à¸Šà¸·à¹ˆà¸­à¸•à¹ˆà¸²à¸‡à¹† à¸—à¸µà¹ˆà¸ªà¹ˆà¸‡à¸œà¸¥à¸•à¹ˆà¸­à¸à¸²à¸£à¸„à¸³à¸™à¸§à¸“ Incentive`,
      
      kpi: `à¸„à¸¹à¹ˆà¸¡à¸·à¸­à¸à¸²à¸£à¸„à¸³à¸™à¸§à¸“ KPI à¸ªà¸³à¸«à¸£à¸±à¸šà¸žà¸™à¸±à¸à¸‡à¸²à¸™ à¸„à¸£à¸­à¸šà¸„à¸¥à¸¸à¸¡à¸•à¸±à¸§à¸Šà¸µà¹‰à¸§à¸±à¸”à¸•à¹ˆà¸²à¸‡à¹† à¹€à¸Šà¹ˆà¸™ à¸¢à¸­à¸”à¸‚à¸²à¸¢ à¸ˆà¸³à¸™à¸§à¸™à¸¥à¸¹à¸à¸„à¹‰à¸²à¹ƒà¸«à¸¡à¹ˆ à¸­à¸±à¸•à¸£à¸²à¸à¸²à¸£à¹€à¸à¹‡à¸šà¸«à¸™à¸µà¹‰ à¹à¸¥à¸°à¸„à¸¸à¸“à¸ à¸²à¸žà¸à¸²à¸£à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£ à¸£à¸§à¸¡à¸–à¸¶à¸‡à¸™à¹‰à¸³à¸«à¸™à¸±à¸à¸„à¸°à¹à¸™à¸™à¸‚à¸­à¸‡à¹à¸•à¹ˆà¸¥à¸°à¸•à¸±à¸§à¸Šà¸µà¹‰à¸§à¸±à¸”à¹à¸¥à¸°à¸§à¸´à¸˜à¸µà¸à¸²à¸£à¸›à¸£à¸°à¹€à¸¡à¸´à¸™à¸œà¸¥à¸‡à¸²à¸™`,
      
      insurance: `à¹à¸™à¸§à¸—à¸²à¸‡à¸à¸²à¸£à¸ˆà¹ˆà¸²à¸¢ Incentive à¸ªà¸³à¸«à¸£à¸±à¸šà¸à¸²à¸£à¸‚à¸²à¸¢à¸›à¸£à¸°à¸à¸±à¸™à¸ à¸±à¸¢ à¸£à¸§à¸¡à¸–à¸¶à¸‡à¹€à¸‡à¸·à¹ˆà¸­à¸™à¹„à¸‚à¸à¸²à¸£à¸„à¸³à¸™à¸§à¸“à¹à¸¥à¸°à¸­à¸±à¸•à¸£à¸²à¸à¸²à¸£à¸ˆà¹ˆà¸²à¸¢à¸•à¸²à¸¡à¸›à¸£à¸°à¹€à¸ à¸—à¸›à¸£à¸°à¸à¸±à¸™à¸ à¸±à¸¢à¸•à¹ˆà¸²à¸‡à¹† à¹€à¸Šà¹ˆà¸™ à¸›à¸£à¸°à¸à¸±à¸™à¸£à¸–à¸¢à¸™à¸•à¹Œ à¸›à¸£à¸°à¸à¸±à¸™à¸­à¸¸à¸šà¸±à¸•à¸´à¹€à¸«à¸•à¸¸ à¹à¸¥à¸°à¸›à¸£à¸°à¸à¸±à¸™à¸ªà¸¸à¸‚à¸ à¸²à¸ž à¸žà¸£à¹‰à¸­à¸¡à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸à¸²à¸£à¸”à¸³à¹€à¸™à¸´à¸™à¸à¸²à¸£`,
      
      mortgage: `à¸„à¸¹à¹ˆà¸¡à¸·à¸­à¸œà¸¥à¸´à¸•à¸ à¸±à¸“à¸‘à¹Œà¸ˆà¸³à¸™à¸³à¸—à¸µà¹ˆà¸”à¸´à¸™ à¸„à¸£à¸­à¸šà¸„à¸¥à¸¸à¸¡à¹€à¸‡à¸·à¹ˆà¸­à¸™à¹„à¸‚à¸à¸²à¸£à¹ƒà¸«à¹‰à¸ªà¸´à¸™à¹€à¸Šà¸·à¹ˆà¸­ à¸­à¸±à¸•à¸£à¸²à¸”à¸­à¸à¹€à¸šà¸µà¹‰à¸¢ à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸à¸²à¸£à¸›à¸£à¸°à¹€à¸¡à¸´à¸™à¸«à¸¥à¸±à¸à¸—à¸£à¸±à¸žà¸¢à¹Œ à¹à¸¥à¸°à¸à¸£à¸°à¸šà¸§à¸™à¸à¸²à¸£à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´ à¸£à¸§à¸¡à¸–à¸¶à¸‡à¹à¸™à¸§à¸—à¸²à¸‡à¸à¸²à¸£à¸ˆà¸±à¸”à¸à¸²à¸£à¸„à¸§à¸²à¸¡à¹€à¸ªà¸µà¹ˆà¸¢à¸‡à¹à¸¥à¸°à¸à¸²à¸£à¸•à¸´à¸”à¸•à¸²à¸¡à¸«à¸™à¸µà¹‰`,
      
      product: `à¸„à¸¹à¹ˆà¸¡à¸·à¸­à¸œà¸¥à¸´à¸•à¸ à¸±à¸“à¸‘à¹Œà¹à¸¥à¸°à¸à¸²à¸£à¸•à¸¥à¸²à¸” à¸„à¸£à¸­à¸šà¸„à¸¥à¸¸à¸¡à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”à¸œà¸¥à¸´à¸•à¸ à¸±à¸“à¸‘à¹Œ à¸à¸¥à¸¢à¸¸à¸—à¸˜à¹Œà¸à¸²à¸£à¸‚à¸²à¸¢ à¹€à¸‡à¸·à¹ˆà¸­à¸™à¹„à¸‚à¹‚à¸›à¸£à¹‚à¸¡à¸Šà¸±à¹ˆà¸™ à¹à¸¥à¸°à¹à¸™à¸§à¸—à¸²à¸‡à¸à¸²à¸£à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£à¸¥à¸¹à¸à¸„à¹‰à¸² à¹€à¸«à¸¡à¸²à¸°à¸ªà¸³à¸«à¸£à¸±à¸šà¸žà¸™à¸±à¸à¸‡à¸²à¸™à¸‚à¸²à¸¢à¹à¸¥à¸°à¸—à¸µà¸¡à¸à¸²à¸£à¸•à¸¥à¸²à¸”`,
      
      general: `à¹€à¸­à¸à¸ªà¸²à¸£à¹à¸™à¸§à¸—à¸²à¸‡à¹à¸¥à¸°à¸„à¸¹à¹ˆà¸¡à¸·à¸­à¸à¸²à¸£à¸›à¸à¸´à¸šà¸±à¸•à¸´à¸‡à¸²à¸™ à¸„à¸£à¸­à¸šà¸„à¸¥à¸¸à¸¡à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸à¸²à¸£à¸”à¸³à¹€à¸™à¸´à¸™à¸à¸²à¸£ à¸à¸Žà¸£à¸°à¹€à¸šà¸µà¸¢à¸šà¸—à¸µà¹ˆà¹€à¸à¸µà¹ˆà¸¢à¸§à¸‚à¹‰à¸­à¸‡ à¹à¸¥à¸°à¹à¸™à¸§à¸—à¸²à¸‡à¸›à¸à¸´à¸šà¸±à¸•à¸´à¸—à¸µà¹ˆà¸”à¸µ à¹€à¸«à¸¡à¸²à¸°à¸ªà¸³à¸«à¸£à¸±à¸šà¸à¸²à¸£à¸­à¹‰à¸²à¸‡à¸­à¸´à¸‡à¹à¸¥à¸°à¸¨à¸¶à¸à¸©à¸²à¹€à¸žà¸´à¹ˆà¸¡à¹€à¸•à¸´à¸¡`
    };

    return templates[type] || templates.general;
  }

  // Generate content sections based on document type
  generateContent(fileName, type) {
    const contentTemplates = {
      incentive: [
        {
          title: "ðŸ’° à¹€à¸à¸“à¸‘à¹Œà¸à¸²à¸£à¸„à¸³à¸™à¸§à¸“ Incentive",
          text: "à¸à¸²à¸£à¸„à¸³à¸™à¸§à¸“ Incentive à¸£à¸°à¸”à¸±à¸šà¸ªà¸²à¸‚à¸²à¸ˆà¸°à¸žà¸´à¸ˆà¸²à¸£à¸“à¸²à¸ˆà¸²à¸à¸œà¸¥à¸‡à¸²à¸™à¸‚à¸²à¸¢ KPI à¸›à¸£à¸°à¸ˆà¸³à¹€à¸”à¸·à¸­à¸™ à¹à¸¥à¸°à¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢à¸—à¸µà¹ˆà¸à¸³à¸«à¸™à¸”à¹„à¸§à¹‰ à¹‚à¸”à¸¢à¸¡à¸µà¸à¸²à¸£à¹à¸šà¹ˆà¸‡à¸•à¸²à¸¡à¸›à¸£à¸°à¹€à¸ à¸—à¸œà¸¥à¸´à¸•à¸ à¸±à¸“à¸‘à¹Œ"
        },
        {
          title: "ðŸ“Š à¸œà¸¥à¸´à¸•à¸ à¸±à¸“à¸‘à¹Œà¸—à¸µà¹ˆà¸™à¸±à¸šà¹€à¸‚à¹‰à¸² KPI",
          text: "à¸›à¸£à¸°à¸à¸±à¸™à¸ à¸±à¸¢ à¸ªà¸´à¸™à¹€à¸Šà¸·à¹ˆà¸­à¸ªà¹ˆà¸§à¸™à¸šà¸¸à¸„à¸„à¸¥ à¸ˆà¸³à¸™à¸³à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¸£à¸– à¹à¸¥à¸°à¸œà¸¥à¸´à¸•à¸ à¸±à¸“à¸‘à¹Œà¸ˆà¸³à¸™à¸³à¸—à¸µà¹ˆà¸”à¸´à¸™ à¸¡à¸µà¸­à¸±à¸•à¸£à¸²à¸à¸²à¸£à¸„à¸³à¸™à¸§à¸“à¹à¸¥à¸°à¹€à¸‡à¸·à¹ˆà¸­à¸™à¹„à¸‚à¸—à¸µà¹ˆà¹à¸•à¸à¸•à¹ˆà¸²à¸‡à¸à¸±à¸™"
        },
        {
          title: "ðŸŽ¯ à¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢à¹à¸¥à¸°à¹‚à¸šà¸™à¸±à¸ª",
          text: "à¸à¸²à¸£à¸šà¸£à¸£à¸¥à¸¸à¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢à¸ˆà¸°à¹„à¸”à¹‰à¸£à¸±à¸šà¹‚à¸šà¸™à¸±à¸ªà¹€à¸žà¸´à¹ˆà¸¡à¹€à¸•à¸´à¸¡ à¹à¸¥à¸°à¸¡à¸µà¸£à¸°à¸šà¸šà¸à¸²à¸£à¸ˆà¹ˆà¸²à¸¢ Incentive à¹à¸šà¸šà¸‚à¸±à¹‰à¸™à¸šà¸±à¸™à¹„à¸”à¸•à¸²à¸¡à¸œà¸¥à¸‡à¸²à¸™à¸—à¸µà¹ˆà¹€à¸à¸´à¸™à¹€à¸›à¹‰à¸²"
        }
      ],
      kpi: [
        {
          title: "ðŸ“ˆ à¸•à¸±à¸§à¸Šà¸µà¹‰à¸§à¸±à¸”à¸«à¸¥à¸±à¸",
          text: "KPI à¸›à¸£à¸°à¸à¸­à¸šà¸”à¹‰à¸§à¸¢à¸¢à¸­à¸”à¸‚à¸²à¸¢ à¸ˆà¸³à¸™à¸§à¸™à¸¥à¸¹à¸à¸„à¹‰à¸²à¹ƒà¸«à¸¡à¹ˆ à¸­à¸±à¸•à¸£à¸²à¸à¸²à¸£à¹€à¸à¹‡à¸šà¸«à¸™à¸µà¹‰ à¹à¸¥à¸°à¸„à¸¸à¸“à¸ à¸²à¸žà¸à¸²à¸£à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£ à¹à¸•à¹ˆà¸¥à¸°à¸•à¸±à¸§à¸Šà¸µà¹‰à¸§à¸±à¸”à¸¡à¸µà¸™à¹‰à¸³à¸«à¸™à¸±à¸à¸„à¸°à¹à¸™à¸™à¸—à¸µà¹ˆà¹à¸•à¸à¸•à¹ˆà¸²à¸‡à¸à¸±à¸™"
        },
        {
          title: "âš–ï¸ à¸à¸²à¸£à¸›à¸£à¸°à¹€à¸¡à¸´à¸™à¸œà¸¥à¸‡à¸²à¸™",
          text: "à¸à¸²à¸£à¸›à¸£à¸°à¹€à¸¡à¸´à¸™à¸ˆà¸°à¸—à¸³à¹€à¸›à¹‡à¸™à¸£à¸²à¸¢à¹€à¸”à¸·à¸­à¸™à¹à¸¥à¸°à¸£à¸²à¸¢à¹„à¸•à¸£à¸¡à¸²à¸ª à¹‚à¸”à¸¢à¸žà¸´à¸ˆà¸²à¸£à¸“à¸²à¸ˆà¸²à¸à¸œà¸¥à¸‡à¸²à¸™à¹€à¸—à¸µà¸¢à¸šà¸à¸±à¸šà¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢à¸—à¸µà¹ˆà¸à¸³à¸«à¸™à¸”"
        },
        {
          title: "ðŸ† à¹€à¸à¸“à¸‘à¹Œà¸à¸²à¸£à¹ƒà¸«à¹‰à¸„à¸°à¹à¸™à¸™",
          text: "à¸¡à¸µà¸£à¸°à¸”à¸±à¸šà¸„à¸°à¹à¸™à¸™à¸•à¸±à¹‰à¸‡à¹à¸•à¹ˆ 1-5 à¹‚à¸”à¸¢ 3 à¸„à¸·à¸­à¸£à¸°à¸”à¸±à¸šà¸¡à¸²à¸•à¸£à¸à¸²à¸™ 4-5 à¸„à¸·à¸­à¹€à¸à¸´à¸™à¹€à¸›à¹‰à¸² à¹à¸¥à¸° 1-2 à¸„à¸·à¸­à¸•à¹ˆà¸³à¸à¸§à¹ˆà¸²à¹€à¸›à¹‰à¸²"
        }
      ],
      insurance: [
        {
          title: "ðŸš— à¸›à¸£à¸°à¸à¸±à¸™à¸£à¸–à¸¢à¸™à¸•à¹Œ",
          text: "à¸„à¸£à¸­à¸šà¸„à¸¥à¸¸à¸¡à¸›à¸£à¸°à¸à¸±à¸™à¸ à¸±à¸¢à¸£à¸–à¸¢à¸™à¸•à¹Œà¸—à¸¸à¸à¸›à¸£à¸°à¹€à¸ à¸— à¸¡à¸µà¸­à¸±à¸•à¸£à¸² Incentive à¸•à¸²à¸¡à¸›à¸£à¸°à¹€à¸ à¸—à¹à¸¥à¸°à¸£à¸°à¸¢à¸°à¹€à¸§à¸¥à¸²à¸à¸²à¸£à¸Šà¸³à¸£à¸°à¹€à¸šà¸µà¹‰à¸¢"
        },
        {
          title: "ðŸ¥ à¸›à¸£à¸°à¸à¸±à¸™à¸ªà¸¸à¸‚à¸ à¸²à¸ž",
          text: "à¸›à¸£à¸°à¸à¸±à¸™à¸ªà¸¸à¸‚à¸ à¸²à¸žà¹à¸¥à¸°à¹‚à¸£à¸„à¸£à¹‰à¸²à¸¢à¹à¸£à¸‡ à¸¡à¸µà¸Šà¹ˆà¸­à¸‡à¸—à¸²à¸‡à¸à¸²à¸£à¸‚à¸²à¸¢à¸­à¸­à¸™à¹„à¸¥à¸™à¹Œà¹à¸¥à¸°à¸«à¸™à¹‰à¸²à¸ªà¸²à¸‚à¸²"
        },
        {
          title: "âš¡ à¸›à¸£à¸°à¸à¸±à¸™à¸­à¸¸à¸šà¸±à¸•à¸´à¹€à¸«à¸•à¸¸",
          text: "à¸›à¸£à¸°à¸à¸±à¸™à¸­à¸¸à¸šà¸±à¸•à¸´à¹€à¸«à¸•à¸¸à¸ªà¹ˆà¸§à¸™à¸šà¸¸à¸„à¸„à¸¥à¹à¸¥à¸°à¸à¸¥à¸¸à¹ˆà¸¡ à¹€à¸«à¸¡à¸²à¸°à¸ªà¸³à¸«à¸£à¸±à¸šà¸¥à¸¹à¸à¸„à¹‰à¸²à¸—à¸¸à¸à¸à¸¥à¸¸à¹ˆà¸¡à¸­à¸²à¸¢à¸¸"
        }
      ],
      mortgage: [
        {
          title: "ðŸ  à¹€à¸‡à¸·à¹ˆà¸­à¸™à¹„à¸‚à¸à¸²à¸£à¹ƒà¸«à¹‰à¸ªà¸´à¸™à¹€à¸Šà¸·à¹ˆà¸­",
          text: "à¸à¸²à¸£à¸ˆà¸³à¸™à¸³à¸—à¸µà¹ˆà¸”à¸´à¸™à¸•à¹‰à¸­à¸‡à¸¡à¸µà¹€à¸­à¸à¸ªà¸²à¸£à¸ªà¸´à¸—à¸˜à¸´à¹Œà¸„à¸£à¸šà¸–à¹‰à¸§à¸™ à¹à¸¥à¸°à¸œà¹ˆà¸²à¸™à¸à¸²à¸£à¸›à¸£à¸°à¹€à¸¡à¸´à¸™à¸£à¸²à¸„à¸²à¸ˆà¸²à¸à¸œà¸¹à¹‰à¸›à¸£à¸°à¹€à¸¡à¸´à¸™à¸—à¸µà¹ˆà¹„à¸”à¹‰à¸£à¸±à¸šà¸­à¸™à¸¸à¸à¸²à¸•"
        },
        {
          title: "ðŸ’¹ à¸­à¸±à¸•à¸£à¸²à¸”à¸­à¸à¹€à¸šà¸µà¹‰à¸¢",
          text: "à¸­à¸±à¸•à¸£à¸²à¸”à¸­à¸à¹€à¸šà¸µà¹‰à¸¢à¹à¸šà¸šà¸„à¸‡à¸—à¸µà¹ˆà¹à¸¥à¸°à¹à¸šà¸šà¸¥à¸­à¸¢à¸•à¸±à¸§ à¸‚à¸¶à¹‰à¸™à¸­à¸¢à¸¹à¹ˆà¸à¸±à¸šà¸¡à¸¹à¸¥à¸„à¹ˆà¸²à¸«à¸¥à¸±à¸à¸—à¸£à¸±à¸žà¸¢à¹Œà¹à¸¥à¸°à¸£à¸°à¸¢à¸°à¹€à¸§à¸¥à¸²à¸à¸²à¸£à¸œà¹ˆà¸­à¸™à¸Šà¸³à¸£à¸°"
        },
        {
          title: "ðŸ“‹ à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸à¸²à¸£à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´",
          text: "à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¹€à¸­à¸à¸ªà¸²à¸£ à¸›à¸£à¸°à¹€à¸¡à¸´à¸™à¸«à¸¥à¸±à¸à¸—à¸£à¸±à¸žà¸¢à¹Œ à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œà¸„à¸§à¸²à¸¡à¹€à¸ªà¸µà¹ˆà¸¢à¸‡ à¹à¸¥à¸°à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´à¸ªà¸´à¸™à¹€à¸Šà¸·à¹ˆà¸­à¸•à¸²à¸¡à¸­à¸³à¸™à¸²à¸ˆà¸­à¸™à¸¸à¸¡à¸±à¸•à¸´"
        }
      ],
      product: [
        {
          title: "ðŸŽ¯ à¸à¸¥à¸¢à¸¸à¸—à¸˜à¹Œà¸à¸²à¸£à¸‚à¸²à¸¢",
          text: "à¹à¸™à¸§à¸—à¸²à¸‡à¸à¸²à¸£à¸™à¸³à¹€à¸ªà¸™à¸­à¸œà¸¥à¸´à¸•à¸ à¸±à¸“à¸‘à¹Œà¹ƒà¸«à¹‰à¹€à¸«à¸¡à¸²à¸°à¸ªà¸¡à¸à¸±à¸šà¸„à¸§à¸²à¸¡à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸‚à¸­à¸‡à¸¥à¸¹à¸à¸„à¹‰à¸²à¹à¸•à¹ˆà¸¥à¸°à¸à¸¥à¸¸à¹ˆà¸¡"
        },
        {
          title: "ðŸŽ à¹‚à¸›à¸£à¹‚à¸¡à¸Šà¸±à¹ˆà¸™",
          text: "à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”à¹‚à¸›à¸£à¹‚à¸¡à¸Šà¸±à¹ˆà¸™à¸žà¸´à¹€à¸¨à¸©à¹à¸¥à¸°à¹€à¸‡à¸·à¹ˆà¸­à¸™à¹„à¸‚à¸à¸²à¸£à¹ƒà¸«à¹‰à¸ªà¹ˆà¸§à¸™à¸¥à¸”à¸«à¸£à¸·à¸­à¸‚à¸­à¸‡à¹à¸–à¸¡"
        },
        {
          title: "ðŸ‘¥ à¸à¸²à¸£à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£",
          text: "à¸¡à¸²à¸•à¸£à¸à¸²à¸™à¸à¸²à¸£à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£à¹à¸¥à¸°à¸à¸²à¸£à¸”à¸¹à¹à¸¥à¸¥à¸¹à¸à¸„à¹‰à¸²à¸«à¸¥à¸±à¸‡à¸à¸²à¸£à¸‚à¸²à¸¢"
        }
      ],
      general: [
        {
          title: "ðŸ“š à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸à¸²à¸£à¸›à¸à¸´à¸šà¸±à¸•à¸´",
          text: "à¹à¸™à¸§à¸—à¸²à¸‡à¹à¸¥à¸°à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸à¸²à¸£à¸”à¸³à¹€à¸™à¸´à¸™à¸‡à¸²à¸™à¸•à¸²à¸¡à¸¡à¸²à¸•à¸£à¸à¸²à¸™à¸—à¸µà¹ˆà¸à¸³à¸«à¸™à¸”"
        },
        {
          title: "âš–ï¸ à¸à¸Žà¸£à¸°à¹€à¸šà¸µà¸¢à¸š",
          text: "à¸à¸Žà¸£à¸°à¹€à¸šà¸µà¸¢à¸šà¹à¸¥à¸°à¸‚à¹‰à¸­à¸šà¸±à¸‡à¸„à¸±à¸šà¸—à¸µà¹ˆà¹€à¸à¸µà¹ˆà¸¢à¸§à¸‚à¹‰à¸­à¸‡à¸à¸±à¸šà¸à¸²à¸£à¸›à¸à¸´à¸šà¸±à¸•à¸´à¸‡à¸²à¸™"
        },
        {
          title: "âœ… à¹à¸™à¸§à¸—à¸²à¸‡à¸›à¸à¸´à¸šà¸±à¸•à¸´à¸—à¸µà¹ˆà¸”à¸µ",
          text: "Best Practices à¹à¸¥à¸°à¸‚à¹‰à¸­à¹à¸™à¸°à¸™à¸³à¸ªà¸³à¸«à¸£à¸±à¸šà¸à¸²à¸£à¸—à¸³à¸‡à¸²à¸™à¸—à¸µà¹ˆà¸¡à¸µà¸›à¸£à¸°à¸ªà¸´à¸—à¸˜à¸´à¸ à¸²à¸ž"
        }
      ]
    };

    return contentTemplates[type] || contentTemplates.general;
  }

  // Get file list from specific folder
  async getFilesFromFolder(folderPath) {
    try {
      // In a real application, this would make an API call
      // For now, we'll return the known files from the folders
      const files = {
        'kb-engine-fe/08-20251218T105837Z-1-001/08': [
          'à¸ªà¸·à¹ˆà¸­à¸„à¸§à¸²à¸¡à¸ªà¸²à¸‚à¸²-_-Incentive-à¸›à¸£à¸°à¸à¸±à¸™à¸£à¸°à¸”à¸±à¸šà¸ªà¸²à¸‚à¸².pdf',
          'à¸ªà¸·à¹ˆà¸­à¸„à¸§à¸²à¸¡à¸ªà¸²à¸‚à¸²-_-à¸à¸²à¸£à¸„à¸´à¸”-Incentive-à¸£à¸°à¸”à¸±à¸šà¸ªà¸²à¸‚à¸²-1.pdf',
          'à¸ªà¸·à¹ˆà¸­à¸„à¸§à¸²à¸¡à¸ªà¸²à¸‚à¸²-_-à¸à¸²à¸£à¸„à¸´à¸”-Incentive-à¸£à¸°à¸”à¸±à¸šà¸ªà¸²à¸‚à¸²-2.pdf',
          'à¸ªà¸·à¹ˆà¸­à¸„à¸§à¸²à¸¡à¸ªà¸²à¸‚à¸²-_-à¸à¸²à¸£à¸„à¸´à¸”-Incentive-à¸£à¸°à¸”à¸±à¸šà¸ªà¸²à¸‚à¸²-3.pdf',
          'à¸ªà¸·à¹ˆà¸­à¸„à¸§à¸²à¸¡à¸ªà¸²à¸‚à¸²-_-à¸à¸²à¸£à¸„à¸´à¸”-KPI-à¸£à¸°à¸”à¸±à¸šà¸ªà¸²à¸‚à¸²-1.pdf',
          'à¸ªà¸·à¹ˆà¸­à¸„à¸§à¸²à¸¡à¸ªà¸²à¸‚à¸²-_-à¸œà¸¥à¸´à¸•à¸ à¸±à¸“à¸‘à¹Œà¸ˆà¸³à¸™à¸³à¸—à¸µà¹ˆà¸”à¸´à¸™.pdf',
          'à¸ªà¸·à¹ˆà¸­à¸„à¸§à¸²à¸¡à¸ªà¸²à¸‚à¸²-Turbo-Celebrity.pdf',
          'à¸ªà¸·à¹ˆà¸­à¸„à¸§à¸²à¸¡à¸ªà¸²à¸‚à¸²-Turbo-Celebrity-1.pdf',
          'à¸ªà¸·à¹ˆà¸­à¸„à¸§à¸²à¸¡à¸ªà¸²à¸‚à¸²-Turbo-Celebrity-2.pdf',
          'à¸ªà¸·à¹ˆà¸­à¸„à¸§à¸²à¸¡à¸ªà¸²à¸‚à¸²-Turbo-Celebrity-3.pdf'
        ],
        'kb-engine-fe/09-20251218T105843Z-1-001/09': [
          'à¸ªà¸·à¹ˆà¸­à¸„à¸§à¸²à¸¡à¸ªà¸²à¸‚à¸²-_-Incentive-à¸›à¸£à¸°à¸à¸±à¸™-à¸£à¸°à¸”à¸±à¸šà¸œà¸¹à¹‰à¸ˆà¸±à¸”à¸à¸²à¸£à¸žà¸·à¹‰à¸™à¸—à¸µà¹ˆà¹à¸¥à¸°à¸ à¸²à¸„-2025.pdf',
          'à¸ªà¸·à¹ˆà¸­à¸„à¸§à¸²à¸¡à¸ªà¸²à¸‚à¸²-_-Incentive-à¸›à¸£à¸°à¸à¸±à¸™-à¸£à¸°à¸”à¸±à¸šà¸œà¸¹à¹‰à¸ˆà¸±à¸”à¸à¸²à¸£à¸žà¸·à¹‰à¸™à¸—à¸µà¹ˆà¹à¸¥à¸°à¸ à¸²à¸„-2025-1.pdf',
          'à¸ªà¸·à¹ˆà¸­à¸„à¸§à¸²à¸¡à¸ªà¸²à¸‚à¸²-_-Incentive-à¸›à¸£à¸°à¸à¸±à¸™à¸£à¸°à¸”à¸±à¸šà¸ªà¸²à¸‚à¸²-1.pdf',
          'à¸ªà¸·à¹ˆà¸­à¸„à¸§à¸²à¸¡à¸ªà¸²à¸‚à¸²-_-à¸à¸²à¸£à¸„à¸´à¸”-Incentive-à¸£à¸°à¸”à¸±à¸šà¸ªà¸²à¸‚à¸².pdf',
          'à¸ªà¸·à¹ˆà¸­à¸„à¸§à¸²à¸¡à¸ªà¸²à¸‚à¸²-_-à¸à¸²à¸£à¸„à¸´à¸”-Incentive-à¸£à¸°à¸”à¸±à¸šà¸ªà¸²à¸‚à¸²-4.pdf',
          'à¸ªà¸·à¹ˆà¸­à¸„à¸§à¸²à¸¡à¸ªà¸²à¸‚à¸²-_-à¸à¸²à¸£à¸„à¸´à¸”-Incentive-à¸£à¸°à¸”à¸±à¸šà¸žà¸·à¹‰à¸™à¸—à¸µà¹ˆ.pdf',
          'à¸ªà¸·à¹ˆà¸­à¸„à¸§à¸²à¸¡à¸ªà¸²à¸‚à¸²-_-à¸à¸²à¸£à¸„à¸´à¸”-KPI-à¸£à¸°à¸”à¸±à¸šà¸žà¸·à¹‰à¸™à¸—à¸µà¹ˆ.pdf',
          'à¸ªà¸·à¹ˆà¸­à¸„à¸§à¸²à¸¡à¸ªà¸²à¸‚à¸²-_-à¸à¸²à¸£à¸„à¸´à¸”-KPI-à¸£à¸°à¸”à¸±à¸šà¸ªà¸²à¸‚à¸²-2.pdf',
          'à¸ªà¸·à¹ˆà¸­à¸„à¸§à¸²à¸¡à¸ªà¸²à¸‚à¸²-_-à¸œà¸¥à¸´à¸•à¸ à¸±à¸“à¸‘à¹Œà¸ˆà¸³à¸™à¸³à¸—à¸µà¹ˆà¸”à¸´à¸™-1.pdf',
          'à¸ªà¸·à¹ˆà¸­à¸„à¸§à¸²à¸¡à¸ªà¸²à¸‚à¸²-_-à¸œà¸¥à¸´à¸•à¸ à¸±à¸“à¸‘à¹Œà¸ˆà¸³à¸™à¸³à¸—à¸µà¹ˆà¸”à¸´à¸™-1-1.pdf',
          'à¸ªà¸·à¹ˆà¸­à¸„à¸§à¸²à¸¡à¸ªà¸²à¸‚à¸²-_-à¸œà¸¥à¸´à¸•à¸ à¸±à¸“à¸‘à¹Œà¸ˆà¸³à¸™à¸³à¸—à¸µà¹ˆà¸”à¸´à¸™-2.pdf',
          'à¸ªà¸·à¹ˆà¸­à¸„à¸§à¸²à¸¡à¸ªà¸²à¸‚à¸²-_-à¸œà¸¥à¸´à¸•à¸ à¸±à¸“à¸‘à¹Œà¸ˆà¸³à¸™à¸³à¸—à¸µà¹ˆà¸”à¸´à¸™-2-1.pdf',
          'à¸ªà¸·à¹ˆà¸­à¸„à¸§à¸²à¸¡à¸ªà¸²à¸‚à¸²-_-à¸œà¸¥à¸´à¸•à¸ à¸±à¸“à¸‘à¹Œà¸ˆà¸³à¸™à¸³à¸—à¸µà¹ˆà¸”à¸´à¸™-2-2.pdf'
        ]
      };

      return files[folderPath] || [];
    } catch (error) {
      console.error('Error fetching files:', error);
      return [];
    }
  }

  // Create document object from file path
  createDocumentFromFile(filePath, id) {
    const metadata = this.getDocumentMetadata(filePath);
    const type = this.getDocumentType(metadata.fileName);
    const keywords = this.generateKeywords(metadata.fileName, type);
    const summary = this.generateSummary(metadata.fileName, type, metadata);
    const content = this.generateContent(metadata.fileName, type);
    
    // Estimate word count based on file size and type
    const wordCount = Math.floor(metadata.size * 0.8) + Math.floor(Math.random() * 200);
    
    // Generate image URL based on document type
    const imageUrl = this.generateImageUrl(type, metadata.month);
    
    return {
      id,
      title: `à¸ªà¸·à¹ˆà¸­à¸„à¸§à¸²à¸¡à¸ªà¸²à¸‚à¸² - ${metadata.fileName}`,
      date: `${Math.floor(Math.random() * 28) + 1} ${metadata.month} ${metadata.year}`,
      version: `v${Math.floor(Math.random() * 3) + 1}.${Math.floor(Math.random() * 9)}`,
      image: imageUrl,
      summary,
      content,
      keywords,
      wordCount,
      url: `/documents/${metadata.monthNumber.toString().padStart(2, '0')}/${metadata.fileName.toLowerCase().replace(/\s+/g, '-')}.pdf`,
      filePath,
      type,
      fileSize: metadata.size
    };
  }

  // Generate image URL based on document type
  generateImageUrl(type, month) {
    const colors = {
      incentive: '1e40af',
      kpi: '059669',
      insurance: 'dc2626',
      mortgage: '7c3aed',
      product: 'ea580c',
      general: '374151'
    };
    
    const color = colors[type] || colors.general;
    const text = encodeURIComponent(`à¹€à¸­à¸à¸ªà¸²à¸£${month}+2567`);
    
    return `https://via.placeholder.com/800x300/${color}/ffffff?text=${text}`;
  }

  // Load all documents from both folders
  async loadAllDocuments() {
    try {
      const folder08Files = await this.getFilesFromFolder('kb-engine-fe/08-20251218T105837Z-1-001/08');
      const folder09Files = await this.getFilesFromFolder('kb-engine-fe/09-20251218T105843Z-1-001/09');
      
      const documents = [];
      let id = 1;
      
      // Process September files (folder 09) - these will be "current" and "latest"
      folder09Files.forEach(fileName => {
        const filePath = `kb-engine-fe/09-20251218T105843Z-1-001/09/${fileName}`;
        documents.push(this.createDocumentFromFile(filePath, id++));
      });
      
      // Process August files (folder 08) - these will be "related" (older versions)
      folder08Files.forEach(fileName => {
        const filePath = `kb-engine-fe/08-20251218T105837Z-1-001/08/${fileName}`;
        documents.push(this.createDocumentFromFile(filePath, id++));
      });
      
      return this.categorizeDocuments(documents);
    } catch (error) {
      console.error('Error loading documents:', error);
      return { current: null, related: [], latest: [] };
    }
  }

  // Categorize documents into current, related, and latest
  categorizeDocuments(documents) {
    // Find the main current document (Incentive calculation for September)
    const current = documents.find(doc => 
      doc.filePath.includes('09') && 
      doc.title.includes('à¸à¸²à¸£à¸„à¸´à¸”-Incentive-à¸£à¸°à¸”à¸±à¸šà¸ªà¸²à¸‚à¸²') &&
      !doc.title.includes('-4')
    ) || documents[0];

    // Related documents (similar topics from August)
    const related = documents.filter(doc => 
      doc.filePath.includes('08') && 
      (doc.title.includes('Incentive') || doc.title.includes('KPI'))
    ).slice(0, 4);

    // Latest documents (recent documents from September)
    const latest = documents.filter(doc => 
      doc.filePath.includes('09') && 
      doc.id !== current?.id
    ).slice(0, 4);

    return { current, related, latest };
  }

  // Handle file download/view
  async viewDocument(filePath) {
    try {
      // In a real application, this would handle PDF viewing
      console.log(`Opening document: ${filePath}`);
      
      // For demo purposes, show an alert
      const fileName = filePath.split('/').pop();
      alert(`à¹€à¸›à¸´à¸”à¹€à¸­à¸à¸ªà¸²à¸£: ${fileName}\n\nà¹ƒà¸™à¸£à¸°à¸šà¸šà¸ˆà¸£à¸´à¸‡ à¸ˆà¸°à¹€à¸›à¸´à¸”à¹„à¸Ÿà¸¥à¹Œ PDF à¹ƒà¸™à¸«à¸™à¹‰à¸²à¸•à¹ˆà¸²à¸‡à¹ƒà¸«à¸¡à¹ˆà¸«à¸£à¸·à¸­ PDF viewer`);
      
      return true;
    } catch (error) {
      console.error('Error viewing document:', error);
      return false;
    }
  }

  // Search documents
  searchDocuments(documents, query) {
    if (!query) return documents;
    
    const searchTerm = query.toLowerCase();
    return documents.filter(doc => 
      doc.title.toLowerCase().includes(searchTerm) ||
      doc.summary.toLowerCase().includes(searchTerm) ||
      doc.keywords.some(keyword => keyword.toLowerCase().includes(searchTerm))
    );
  }
}

export default new DocumentService();